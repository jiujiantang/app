async function c(e){const t=await(await fetch(e)).blob();return new Promise((a,r)=>{const n=new FileReader;n.onloadend=()=>a(n.result),n.onerror=r,n.readAsDataURL(t)})}const s=async()=>{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0}),o=`https://picsum.photos/1920/1080?random=${Date.now()}`,t=await c(o);e?.id&&chrome.scripting.executeScript({target:{tabId:e.id},func:a=>{document.body.style.backgroundImage=`linear-gradient(rgba(255,255,255,0.7), rgba(255,255,255,0.7)),url(${a})`,document.body.style.backgroundSize="cover",document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundPosition="center"},args:[t]}),chrome.runtime.sendMessage({action:"save-bg",url:new URL(e.url).hostname,base64:t})};document.getElementById("change-bg").addEventListener("click",async()=>{await s()});
